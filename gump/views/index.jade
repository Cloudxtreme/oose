extends layout
append css
  link(type='text/css', rel='stylesheet', href='/css/dropzone.css')
append js
  script(src='/js/table.js')
  script(src='/bower_components/dropzone/downloads/dropzone.min.js')
block content
  .container
    div
      .pull-right
        form.form-inline#tableSearch(role='form', action='', method='get')
          .form-group
            input.form-control(type='text', name='search', placeholder='Filter Results', value=search)
          .form-group
            a.btn.btn-success(data-toggle='modal',data-target='#folderCreate')
              span.glyphicon.glyphicon-plus
              |  Create Folder
      h1 Files
    +alerts()
    div
      a(href='/?path=/')
        span.glyphicon.glyphicon-folder-open  /
      - var currentPath = '/'
      each item in path.split('/')
        - currentPath += (currentPath !== '/' ? '/' : '') + item
        if item
          | &nbsp;
          a(href='/?path=#{currentPath}') #{item}
          span  /
    #dropzone
      form.dropzone(action='/upload?path=#{path}', method='post', id='file-upload')
    form(method='post', role='form')
      table.table.table-striped
        tr
          th
            input#toggle(type='checkbox')
          th
          th Name
          th Type
          th Created
          th Status
        if files.length
          each file in files
            tr
              td
                input(type='checkbox', name='remove[]', value=file.id)
              td
                if file.folder
                  span.glyphicon.glyphicon-folder-close
                else
                  span.glyphicon.glyphicon-file
              td
                if file.folder
                  a(href='/?path=#{file.path}')= file.name
                else
                  a(href='/file?id=#{file.id}')= file.name
              td= file.mimeType
              td= new Date(file.metrics.dateCreated).toDateString()
              td= file.status
        else
          tr
            td(colspan='4') No entries exist
      div
        span #{count || 0} entries
        div
          button.btn.btn-danger#tableDelete(type='submit') Delete Checked
  #folderCreate.modal(tabindex='-1',role='dialog',aria-labelledby='folderCreate',aria-hidden='true')
    .modal-dialog.modal-sm
      .modal-content
        form(method='post', action='/folderCreate?path=#{path}')
          button.close(type='button',data-dismiss='modal',aria-hidden='true')
          .modal-header
            h2 Create Folder in #{path}
          .modal-body
            .form-group
              .col-sm-10
                input.form-control(type='text', name='name', placeholder='Folder Name; Must contain no forward slashes(/)')
          .modal-footer
            button.btn.btn-info.pull-left(type='button',data-dismiss='modal') Close
            button.btn.btn-danger(type='submit') Create Folder